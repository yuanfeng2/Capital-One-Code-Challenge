{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [],
   "source": [
    "%config InlineBackend.figure_format = 'retina'\n",
    "import time\n",
    "import warnings\n",
    "warnings.filterwarnings('ignore')\n",
    "import json\n",
    "import csv\n",
    "import codecs\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "from matplotlib import cm\n",
    "from sklearn.metrics import roc_curve, auc, precision_recall_curve, f1_score,roc_auc_score\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "tran = pd.read_csv('transactions.txt')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>{\"accountNumber\": \"737265056\"</th>\n",
       "      <th>\"customerId\": \"737265056\"</th>\n",
       "      <th>\"creditLimit\": 5000.0</th>\n",
       "      <th>\"availableMoney\": 5000.0</th>\n",
       "      <th>\"transactionDateTime\": \"2016-08-13T14:27:32\"</th>\n",
       "      <th>\"transactionAmount\": 98.55</th>\n",
       "      <th>\"merchantName\": \"Uber\"</th>\n",
       "      <th>\"acqCountry\": \"US\"</th>\n",
       "      <th>\"merchantCountryCode\": \"US\"</th>\n",
       "      <th>\"posEntryMode\": \"02\"</th>\n",
       "      <th>...</th>\n",
       "      <th>\"echoBuffer\": \"\"</th>\n",
       "      <th>\"currentBalance\": 0.0</th>\n",
       "      <th>\"merchantCity\": \"\"</th>\n",
       "      <th>\"merchantState\": \"\"</th>\n",
       "      <th>\"merchantZip\": \"\"</th>\n",
       "      <th>\"cardPresent\": false</th>\n",
       "      <th>\"posOnPremises\": \"\"</th>\n",
       "      <th>\"recurringAuthInd\": \"\"</th>\n",
       "      <th>\"expirationDateKeyInMatch\": false</th>\n",
       "      <th>\"isFraud\": false}</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>786362</td>\n",
       "      <td>786362</td>\n",
       "      <td>786362</td>\n",
       "      <td>786362</td>\n",
       "      <td>786362</td>\n",
       "      <td>786362</td>\n",
       "      <td>786362</td>\n",
       "      <td>786362</td>\n",
       "      <td>786362</td>\n",
       "      <td>786362</td>\n",
       "      <td>...</td>\n",
       "      <td>786362</td>\n",
       "      <td>786362</td>\n",
       "      <td>786362</td>\n",
       "      <td>786362</td>\n",
       "      <td>786362</td>\n",
       "      <td>786362</td>\n",
       "      <td>786362</td>\n",
       "      <td>786362</td>\n",
       "      <td>786362</td>\n",
       "      <td>786362</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>unique</th>\n",
       "      <td>5000</td>\n",
       "      <td>5000</td>\n",
       "      <td>10</td>\n",
       "      <td>521916</td>\n",
       "      <td>520959</td>\n",
       "      <td>762642</td>\n",
       "      <td>67848</td>\n",
       "      <td>2500</td>\n",
       "      <td>17</td>\n",
       "      <td>28</td>\n",
       "      <td>...</td>\n",
       "      <td>4588</td>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "      <td>8</td>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>top</th>\n",
       "      <td>{\"accountNumber\": \"380680241\"</td>\n",
       "      <td>\"customerId\": \"380680241\"</td>\n",
       "      <td>\"creditLimit\": 5000.0</td>\n",
       "      <td>\"availableMoney\": 250.0</td>\n",
       "      <td>\"currentBalance\": 8.46</td>\n",
       "      <td>\"merchantName\": \"Apple iTunes\"</td>\n",
       "      <td>\"merchantName\": \"Uber\"</td>\n",
       "      <td>\"acqCountry\": \"US\"</td>\n",
       "      <td>\"acqCountry\": \"US\"</td>\n",
       "      <td>\"merchantCountryCode\": \"US\"</td>\n",
       "      <td>...</td>\n",
       "      <td>\"transactionType\": \"PURCHASE\"</td>\n",
       "      <td>\"echoBuffer\": \"\"</td>\n",
       "      <td>\"merchantCity\": \"\"</td>\n",
       "      <td>\"merchantState\": \"\"</td>\n",
       "      <td>\"merchantZip\": \"\"</td>\n",
       "      <td>\"cardPresent\": false</td>\n",
       "      <td>\"posOnPremises\": \"\"</td>\n",
       "      <td>\"recurringAuthInd\": \"\"</td>\n",
       "      <td>\"expirationDateKeyInMatch\": false</td>\n",
       "      <td>\"isFraud\": false}</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>freq</th>\n",
       "      <td>32850</td>\n",
       "      <td>32850</td>\n",
       "      <td>201862</td>\n",
       "      <td>6015</td>\n",
       "      <td>26</td>\n",
       "      <td>36</td>\n",
       "      <td>1690</td>\n",
       "      <td>53113</td>\n",
       "      <td>720610</td>\n",
       "      <td>720606</td>\n",
       "      <td>...</td>\n",
       "      <td>396456</td>\n",
       "      <td>399608</td>\n",
       "      <td>423752</td>\n",
       "      <td>423752</td>\n",
       "      <td>423752</td>\n",
       "      <td>424202</td>\n",
       "      <td>772245</td>\n",
       "      <td>772245</td>\n",
       "      <td>772245</td>\n",
       "      <td>773945</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>4 rows × 29 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        {\"accountNumber\": \"737265056\"   \"customerId\": \"737265056\"  \\\n",
       "count                          786362                      786362   \n",
       "unique                           5000                        5000   \n",
       "top     {\"accountNumber\": \"380680241\"   \"customerId\": \"380680241\"   \n",
       "freq                            32850                       32850   \n",
       "\n",
       "         \"creditLimit\": 5000.0  \"availableMoney\": 5000.0  \\\n",
       "count                   786362                    786362   \n",
       "unique                      10                    521916   \n",
       "top      \"creditLimit\": 5000.0   \"availableMoney\": 250.0   \n",
       "freq                    201862                      6015   \n",
       "\n",
       "        \"transactionDateTime\": \"2016-08-13T14:27:32\"  \\\n",
       "count                                         786362   \n",
       "unique                                        520959   \n",
       "top                           \"currentBalance\": 8.46   \n",
       "freq                                              26   \n",
       "\n",
       "             \"transactionAmount\": 98.55   \"merchantName\": \"Uber\"  \\\n",
       "count                            786362                   786362   \n",
       "unique                           762642                    67848   \n",
       "top      \"merchantName\": \"Apple iTunes\"   \"merchantName\": \"Uber\"   \n",
       "freq                                 36                     1690   \n",
       "\n",
       "         \"acqCountry\": \"US\"  \"merchantCountryCode\": \"US\"  \\\n",
       "count                786362                       786362   \n",
       "unique                 2500                           17   \n",
       "top      \"acqCountry\": \"US\"           \"acqCountry\": \"US\"   \n",
       "freq                  53113                       720610   \n",
       "\n",
       "                \"posEntryMode\": \"02\"  ...                \"echoBuffer\": \"\"  \\\n",
       "count                         786362  ...                          786362   \n",
       "unique                            28  ...                            4588   \n",
       "top      \"merchantCountryCode\": \"US\"  ...   \"transactionType\": \"PURCHASE\"   \n",
       "freq                          720606  ...                          396456   \n",
       "\n",
       "        \"currentBalance\": 0.0   \"merchantCity\": \"\"   \"merchantState\": \"\"  \\\n",
       "count                  786362               786362                786362   \n",
       "unique                     10                   10                     8   \n",
       "top          \"echoBuffer\": \"\"   \"merchantCity\": \"\"   \"merchantState\": \"\"   \n",
       "freq                   399608               423752                423752   \n",
       "\n",
       "         \"merchantZip\": \"\"   \"cardPresent\": false   \"posOnPremises\": \"\"  \\\n",
       "count               786362                 786362                786362   \n",
       "unique                   9                      9                     9   \n",
       "top      \"merchantZip\": \"\"   \"cardPresent\": false   \"posOnPremises\": \"\"   \n",
       "freq                423752                 424202                772245   \n",
       "\n",
       "         \"recurringAuthInd\": \"\"   \"expirationDateKeyInMatch\": false  \\\n",
       "count                    786362                              786362   \n",
       "unique                        4                                   4   \n",
       "top      \"recurringAuthInd\": \"\"   \"expirationDateKeyInMatch\": false   \n",
       "freq                     772245                              772245   \n",
       "\n",
       "         \"isFraud\": false}  \n",
       "count               786362  \n",
       "unique                   4  \n",
       "top      \"isFraud\": false}  \n",
       "freq                773945  \n",
       "\n",
       "[4 rows x 29 columns]"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tran.describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 68,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 786362 entries, 0 to 786361\n",
      "Data columns (total 29 columns):\n",
      " #   Column                                         Non-Null Count   Dtype \n",
      "---  ------                                         --------------   ----- \n",
      " 0   {\"accountNumber\": \"737265056\"                  786362 non-null  object\n",
      " 1    \"customerId\": \"737265056\"                     786362 non-null  object\n",
      " 2    \"creditLimit\": 5000.0                         786362 non-null  object\n",
      " 3    \"availableMoney\": 5000.0                      786362 non-null  object\n",
      " 4    \"transactionDateTime\": \"2016-08-13T14:27:32\"  786362 non-null  object\n",
      " 5    \"transactionAmount\": 98.55                    786362 non-null  object\n",
      " 6    \"merchantName\": \"Uber\"                        786362 non-null  object\n",
      " 7    \"acqCountry\": \"US\"                            786362 non-null  object\n",
      " 8    \"merchantCountryCode\": \"US\"                   786362 non-null  object\n",
      " 9    \"posEntryMode\": \"02\"                          786362 non-null  object\n",
      " 10   \"posConditionCode\": \"01\"                      786362 non-null  object\n",
      " 11   \"merchantCategoryCode\": \"rideshare\"           786362 non-null  object\n",
      " 12   \"currentExpDate\": \"06/2023\"                   786362 non-null  object\n",
      " 13   \"accountOpenDate\": \"2015-03-14\"               786362 non-null  object\n",
      " 14   \"dateOfLastAddressChange\": \"2015-03-14\"       786362 non-null  object\n",
      " 15   \"cardCVV\": \"414\"                              786362 non-null  object\n",
      " 16   \"enteredCVV\": \"414\"                           786362 non-null  object\n",
      " 17   \"cardLast4Digits\": \"1803\"                     786362 non-null  object\n",
      " 18   \"transactionType\": \"PURCHASE\"                 786362 non-null  object\n",
      " 19   \"echoBuffer\": \"\"                              786362 non-null  object\n",
      " 20   \"currentBalance\": 0.0                         786362 non-null  object\n",
      " 21   \"merchantCity\": \"\"                            786362 non-null  object\n",
      " 22   \"merchantState\": \"\"                           786362 non-null  object\n",
      " 23   \"merchantZip\": \"\"                             786362 non-null  object\n",
      " 24   \"cardPresent\": false                          786362 non-null  object\n",
      " 25   \"posOnPremises\": \"\"                           786362 non-null  object\n",
      " 26   \"recurringAuthInd\": \"\"                        786362 non-null  object\n",
      " 27   \"expirationDateKeyInMatch\": false             786362 non-null  object\n",
      " 28   \"isFraud\": false}                             786362 non-null  object\n",
      "dtypes: object(29)\n",
      "memory usage: 174.0+ MB\n"
     ]
    }
   ],
   "source": [
    "tran.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 61,
   "metadata": {},
   "outputs": [
    {
     "ename": "KeyboardInterrupt",
     "evalue": "",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mKeyboardInterrupt\u001b[0m                         Traceback (most recent call last)",
      "\u001b[0;32m<ipython-input-61-458f1a3573cd>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[1;32m      5\u001b[0m     \u001b[0;31m#print line,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      6\u001b[0m     \u001b[0;31m#print(line, end = '')\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 7\u001b[0;31m     \u001b[0mdata\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mappend\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mline\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      8\u001b[0m \u001b[0mf\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mclose\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;31mKeyboardInterrupt\u001b[0m: "
     ]
    }
   ],
   "source": [
    "f = open('transactions copy.txt')\n",
    "data = []\n",
    "line = f.readline() \n",
    "while line: \n",
    "    #print line,                  \n",
    "    print(line, end = '')\n",
    "f.close()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 69,
   "metadata": {},
   "outputs": [],
   "source": [
    "class convert_json_csv():\n",
    "    def __init__(self):\n",
    "        self.save_csv = open('transactions_new.csv', 'w', encoding='utf-8', newline='')\n",
    "        self.write_csv = csv.writer(self.save_csv, delimiter=',')\n",
    "\n",
    "    def convert(self,filename):\n",
    "        with codecs.open(filename,'r',encoding='utf-8') as f:\n",
    "            read=f.readlines()\n",
    "            flag=True\n",
    "            for index,info in enumerate(read):\n",
    "                data=json.loads(info)\n",
    "                if flag: \n",
    "                    keys=list(data.keys())\n",
    "                    self.write_csv.writerow(keys) \n",
    "                    flag=False\n",
    "                value=list(data.values())\n",
    "                self.write_csv.writerow(value)\n",
    "            self.save_csv.close()\n",
    "\n",
    "\n",
    "if __name__=='__main__':\n",
    "    new_file=convert_json_csv()\n",
    "    content='transactions.txt'\n",
    "    new_file.convert(content)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 71,
   "metadata": {},
   "outputs": [],
   "source": [
    "dt = pd.read_csv('transactions_new.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 72,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 786363 entries, 0 to 786362\n",
      "Data columns (total 29 columns):\n",
      " #   Column                    Non-Null Count   Dtype  \n",
      "---  ------                    --------------   -----  \n",
      " 0   accountNumber             786363 non-null  int64  \n",
      " 1   customerId                786363 non-null  int64  \n",
      " 2   creditLimit               786363 non-null  float64\n",
      " 3   availableMoney            786363 non-null  float64\n",
      " 4   transactionDateTime       786363 non-null  object \n",
      " 5   transactionAmount         786363 non-null  object \n",
      " 6   merchantName              786363 non-null  object \n",
      " 7   acqCountry                786363 non-null  object \n",
      " 8   merchantCountryCode       786363 non-null  object \n",
      " 9   posEntryMode              786363 non-null  object \n",
      " 10  posConditionCode          786363 non-null  object \n",
      " 11  merchantCategoryCode      786363 non-null  object \n",
      " 12  currentExpDate            786363 non-null  object \n",
      " 13  accountOpenDate           786363 non-null  object \n",
      " 14  dateOfLastAddressChange   786363 non-null  object \n",
      " 15  cardCVV                   786363 non-null  object \n",
      " 16  enteredCVV                786362 non-null  object \n",
      " 17  cardLast4Digits           786299 non-null  object \n",
      " 18  transactionType           784658 non-null  object \n",
      " 19  echoBuffer                743189 non-null  object \n",
      " 20  currentBalance            381394 non-null  object \n",
      " 21  merchantCity              19267 non-null   object \n",
      " 22  merchantState             164 non-null     object \n",
      " 23  merchantZip               339 non-null     object \n",
      " 24  cardPresent               424203 non-null  object \n",
      " 25  posOnPremises             8953 non-null    object \n",
      " 26  recurringAuthInd          684 non-null     object \n",
      " 27  expirationDateKeyInMatch  772246 non-null  object \n",
      " 28  isFraud                   786336 non-null  object \n",
      "dtypes: float64(2), int64(2), object(25)\n",
      "memory usage: 174.0+ MB\n"
     ]
    }
   ],
   "source": [
    "dt.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 73,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>accountNumber</th>\n",
       "      <th>customerId</th>\n",
       "      <th>creditLimit</th>\n",
       "      <th>availableMoney</th>\n",
       "      <th>transactionDateTime</th>\n",
       "      <th>transactionAmount</th>\n",
       "      <th>merchantName</th>\n",
       "      <th>acqCountry</th>\n",
       "      <th>merchantCountryCode</th>\n",
       "      <th>posEntryMode</th>\n",
       "      <th>...</th>\n",
       "      <th>echoBuffer</th>\n",
       "      <th>currentBalance</th>\n",
       "      <th>merchantCity</th>\n",
       "      <th>merchantState</th>\n",
       "      <th>merchantZip</th>\n",
       "      <th>cardPresent</th>\n",
       "      <th>posOnPremises</th>\n",
       "      <th>recurringAuthInd</th>\n",
       "      <th>expirationDateKeyInMatch</th>\n",
       "      <th>isFraud</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>737265056</td>\n",
       "      <td>737265056</td>\n",
       "      <td>5000.0</td>\n",
       "      <td>5000.00</td>\n",
       "      <td>2016-08-13T14:27:32</td>\n",
       "      <td>98.55</td>\n",
       "      <td>Uber</td>\n",
       "      <td>US</td>\n",
       "      <td>US</td>\n",
       "      <td>02</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>False</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>737265056</td>\n",
       "      <td>737265056</td>\n",
       "      <td>5000.0</td>\n",
       "      <td>5000.00</td>\n",
       "      <td>2016-10-11T05:05:54</td>\n",
       "      <td>74.51</td>\n",
       "      <td>AMC #191138</td>\n",
       "      <td>US</td>\n",
       "      <td>US</td>\n",
       "      <td>09</td>\n",
       "      <td>...</td>\n",
       "      <td>PURCHASE</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>737265056</td>\n",
       "      <td>737265056</td>\n",
       "      <td>5000.0</td>\n",
       "      <td>5000.00</td>\n",
       "      <td>2016-11-08T09:18:39</td>\n",
       "      <td>7.47</td>\n",
       "      <td>Play Store</td>\n",
       "      <td>US</td>\n",
       "      <td>US</td>\n",
       "      <td>09</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>False</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>737265056</td>\n",
       "      <td>737265056</td>\n",
       "      <td>5000.0</td>\n",
       "      <td>5000.00</td>\n",
       "      <td>2016-12-10T02:14:50</td>\n",
       "      <td>7.47</td>\n",
       "      <td>Play Store</td>\n",
       "      <td>US</td>\n",
       "      <td>US</td>\n",
       "      <td>09</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>False</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>830329091</td>\n",
       "      <td>830329091</td>\n",
       "      <td>5000.0</td>\n",
       "      <td>5000.00</td>\n",
       "      <td>2016-03-24T21:04:46</td>\n",
       "      <td>71.18</td>\n",
       "      <td>Tim Hortons #947751</td>\n",
       "      <td>US</td>\n",
       "      <td>US</td>\n",
       "      <td>02</td>\n",
       "      <td>...</td>\n",
       "      <td>PURCHASE</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>786358</th>\n",
       "      <td>732852505</td>\n",
       "      <td>732852505</td>\n",
       "      <td>50000.0</td>\n",
       "      <td>48904.96</td>\n",
       "      <td>1095.04</td>\n",
       "      <td>2016-12-22T18:44:12</td>\n",
       "      <td>119.92</td>\n",
       "      <td>Lyft</td>\n",
       "      <td>US</td>\n",
       "      <td>US</td>\n",
       "      <td>...</td>\n",
       "      <td>PURCHASE</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>False</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>786359</th>\n",
       "      <td>732852505</td>\n",
       "      <td>732852505</td>\n",
       "      <td>50000.0</td>\n",
       "      <td>48785.04</td>\n",
       "      <td>1214.96</td>\n",
       "      <td>2016-12-25T16:20:34</td>\n",
       "      <td>18.89</td>\n",
       "      <td>hulu.com</td>\n",
       "      <td>US</td>\n",
       "      <td>US</td>\n",
       "      <td>...</td>\n",
       "      <td>PURCHASE</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>False</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>786360</th>\n",
       "      <td>732852505</td>\n",
       "      <td>732852505</td>\n",
       "      <td>50000.0</td>\n",
       "      <td>48766.15</td>\n",
       "      <td>1233.85</td>\n",
       "      <td>2016-12-27T15:46:24</td>\n",
       "      <td>49.43</td>\n",
       "      <td>Lyft</td>\n",
       "      <td>US</td>\n",
       "      <td>US</td>\n",
       "      <td>...</td>\n",
       "      <td>PURCHASE</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>False</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>786361</th>\n",
       "      <td>732852505</td>\n",
       "      <td>732852505</td>\n",
       "      <td>50000.0</td>\n",
       "      <td>48716.72</td>\n",
       "      <td>1283.28</td>\n",
       "      <td>2016-12-29T00:30:55</td>\n",
       "      <td>49.89</td>\n",
       "      <td>walmart.com</td>\n",
       "      <td>US</td>\n",
       "      <td>US</td>\n",
       "      <td>...</td>\n",
       "      <td>PURCHASE</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>False</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>786362</th>\n",
       "      <td>732852505</td>\n",
       "      <td>732852505</td>\n",
       "      <td>50000.0</td>\n",
       "      <td>48666.83</td>\n",
       "      <td>1333.17</td>\n",
       "      <td>2016-12-30T20:10:29</td>\n",
       "      <td>72.18</td>\n",
       "      <td>Uber</td>\n",
       "      <td>US</td>\n",
       "      <td>US</td>\n",
       "      <td>...</td>\n",
       "      <td>PURCHASE</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>False</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>786363 rows × 29 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        accountNumber  customerId  creditLimit  availableMoney  \\\n",
       "0           737265056   737265056       5000.0         5000.00   \n",
       "1           737265056   737265056       5000.0         5000.00   \n",
       "2           737265056   737265056       5000.0         5000.00   \n",
       "3           737265056   737265056       5000.0         5000.00   \n",
       "4           830329091   830329091       5000.0         5000.00   \n",
       "...               ...         ...          ...             ...   \n",
       "786358      732852505   732852505      50000.0        48904.96   \n",
       "786359      732852505   732852505      50000.0        48785.04   \n",
       "786360      732852505   732852505      50000.0        48766.15   \n",
       "786361      732852505   732852505      50000.0        48716.72   \n",
       "786362      732852505   732852505      50000.0        48666.83   \n",
       "\n",
       "        transactionDateTime    transactionAmount         merchantName  \\\n",
       "0       2016-08-13T14:27:32                98.55                 Uber   \n",
       "1       2016-10-11T05:05:54                74.51          AMC #191138   \n",
       "2       2016-11-08T09:18:39                 7.47           Play Store   \n",
       "3       2016-12-10T02:14:50                 7.47           Play Store   \n",
       "4       2016-03-24T21:04:46                71.18  Tim Hortons #947751   \n",
       "...                     ...                  ...                  ...   \n",
       "786358              1095.04  2016-12-22T18:44:12               119.92   \n",
       "786359              1214.96  2016-12-25T16:20:34                18.89   \n",
       "786360              1233.85  2016-12-27T15:46:24                49.43   \n",
       "786361              1283.28  2016-12-29T00:30:55                49.89   \n",
       "786362              1333.17  2016-12-30T20:10:29                72.18   \n",
       "\n",
       "         acqCountry merchantCountryCode posEntryMode  ... echoBuffer  \\\n",
       "0                US                  US           02  ...        NaN   \n",
       "1                US                  US           09  ...   PURCHASE   \n",
       "2                US                  US           09  ...        NaN   \n",
       "3                US                  US           09  ...        NaN   \n",
       "4                US                  US           02  ...   PURCHASE   \n",
       "...             ...                 ...          ...  ...        ...   \n",
       "786358         Lyft                  US           US  ...   PURCHASE   \n",
       "786359     hulu.com                  US           US  ...   PURCHASE   \n",
       "786360         Lyft                  US           US  ...   PURCHASE   \n",
       "786361  walmart.com                  US           US  ...   PURCHASE   \n",
       "786362         Uber                  US           US  ...   PURCHASE   \n",
       "\n",
       "       currentBalance merchantCity merchantState merchantZip cardPresent  \\\n",
       "0                 0.0          NaN           NaN         NaN       False   \n",
       "1                 NaN          0.0           NaN         NaN         NaN   \n",
       "2                 0.0          NaN           NaN         NaN       False   \n",
       "3                 0.0          NaN           NaN         NaN       False   \n",
       "4                 NaN          0.0           NaN         NaN         NaN   \n",
       "...               ...          ...           ...         ...         ...   \n",
       "786358            NaN          NaN           NaN         NaN       False   \n",
       "786359            NaN          NaN           NaN         NaN       False   \n",
       "786360            NaN          NaN           NaN         NaN       False   \n",
       "786361            NaN          NaN           NaN         NaN       False   \n",
       "786362            NaN          NaN           NaN         NaN       False   \n",
       "\n",
       "       posOnPremises recurringAuthInd expirationDateKeyInMatch isFraud  \n",
       "0                NaN              NaN                    False   False  \n",
       "1                NaN              NaN                    False   False  \n",
       "2                NaN              NaN                    False   False  \n",
       "3                NaN              NaN                    False   False  \n",
       "4                NaN              NaN                    False   False  \n",
       "...              ...              ...                      ...     ...  \n",
       "786358           NaN              NaN                    False   False  \n",
       "786359           NaN              NaN                    False   False  \n",
       "786360           NaN              NaN                    False   False  \n",
       "786361           NaN              NaN                    False   False  \n",
       "786362           NaN              NaN                    False   False  \n",
       "\n",
       "[786363 rows x 29 columns]"
      ]
     },
     "execution_count": 73,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "dt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 63,
   "metadata": {},
   "outputs": [],
   "source": [
    "trc =pd.read_csv('hotels_out.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 65,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 786363 entries, 0 to 786362\n",
      "Data columns (total 29 columns):\n",
      " #   Column                    Non-Null Count   Dtype  \n",
      "---  ------                    --------------   -----  \n",
      " 0   accountNumber             786363 non-null  int64  \n",
      " 1   customerId                786363 non-null  int64  \n",
      " 2   creditLimit               786363 non-null  float64\n",
      " 3   availableMoney            786363 non-null  float64\n",
      " 4   transactionDateTime       786363 non-null  object \n",
      " 5   transactionAmount         786363 non-null  object \n",
      " 6   merchantName              786363 non-null  object \n",
      " 7   acqCountry                786363 non-null  object \n",
      " 8   merchantCountryCode       786363 non-null  object \n",
      " 9   posEntryMode              786363 non-null  object \n",
      " 10  posConditionCode          786363 non-null  object \n",
      " 11  merchantCategoryCode      786363 non-null  object \n",
      " 12  currentExpDate            786363 non-null  object \n",
      " 13  accountOpenDate           786363 non-null  object \n",
      " 14  dateOfLastAddressChange   786363 non-null  object \n",
      " 15  cardCVV                   786363 non-null  object \n",
      " 16  enteredCVV                786362 non-null  object \n",
      " 17  cardLast4Digits           786299 non-null  object \n",
      " 18  transactionType           784658 non-null  object \n",
      " 19  echoBuffer                743189 non-null  object \n",
      " 20  currentBalance            381394 non-null  object \n",
      " 21  merchantCity              19267 non-null   object \n",
      " 22  merchantState             164 non-null     object \n",
      " 23  merchantZip               339 non-null     object \n",
      " 24  cardPresent               424203 non-null  object \n",
      " 25  posOnPremises             8953 non-null    object \n",
      " 26  recurringAuthInd          684 non-null     object \n",
      " 27  expirationDateKeyInMatch  772246 non-null  object \n",
      " 28  isFraud                   786336 non-null  object \n",
      "dtypes: float64(2), int64(2), object(25)\n",
      "memory usage: 174.0+ MB\n"
     ]
    }
   ],
   "source": [
    "trc.info()"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.1"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
